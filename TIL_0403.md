# TIL_0403

 

# 4장 데이터 링크 계층 : 랜에서 데이터 전송하기



## Lesson 12. 데이터 링크 계층의 역할과 이더넷

OSI 모델 : 물리 계층-**데이터 링크 계층**-네트워크 계층-전송 계층-세션 계층-표현 계층-응용 계층<-송신



데이터 링크 계층 : 

네트워크 장비 간에 신호를 주고받는 규칙을 정하는 계층

일반적으로 이더넷이 가장 많이 사용되는 규칙



허브 remind :

전기 신호를 증폭하고 정형하는 기능(리피터와 같음)+여러 컴퓨터에 신호를 전달함

목적지 외에 다른 컴퓨터들도 신호를 수신하는 문제가 발생



이더넷 : 

허브를 통해 데이터를 보낼 때 데이터에 목적지 정보를 추가함

여러 컴퓨터가 동시에 데이터를 보내면 충돌이 발생하는데 이를 방지하기 위해 데이터를 보내는 시점을 늦추는 방법 CSMA/CD

​	CS : Carrier Sense : '케이블에 신호가 흐르고 있는지를 확인한다'는 규칙

​	MA : Multiple Access : '신호가 흐르지 않는다면 데이터를 보내도 좋다'는 규칙

​	CD : Collision Detection : '충돌이 발생하고 있는지를 확인한다'는 규칙

사실 CSMA/CD는 효율이 좋지 않아 요즘에는 사용하지 않음, 대신 스위치라는 장비를 사용



## Lesson 13. MAC 주소의 구조

랜카드에는 MAC 주소가 정해져 있음, 물리 주소라고도 부름. 고유함.

MAC : Media Access Control

00-23-AE-D9-7A-9A 와 같이 48비트로 구성되어 있는데, 앞 24비트는 제조사 번호 뒤 24비트는 제조사가 붙인 일련번호



데이터 링크 계층에서는 이더넷 헤더와 트레일러를 붙임

이더넷 헤더는 14바이트, 6 목적지 MAC주소, 6 출발지 MAC주소, 2 유형(이더넷으로 전송되는 상위 계층 프로토콜의 종류)

트레일러는 FCS(Frame Check Sequence)라고도 하는데, 전송 도중 오류가 발생하는지 확인하는 용도



이더넷 헤더를 이용한 통신 : 

데이터 링크 계층에서 프레임(헤더+데이터+트레일러)을 만들고(캡슐화), 물리 계층에서 이를 전기신호로 변환하여 전송

데이터를 받은 컴퓨터는 목적지 MAC주소가 자신의 MAC주소와 다르면 데이터를 파기

MAC주소가 일치할 경우 물리 계층에서 전기신호를 비트열로 변환하고, 데이터 링크 계층에서 헤더와 트레일러를 분리(역캡슐화)

만약 충돌이 감지되더라도 CSMA/CD에 의해 문제를 회피할 수 있음



## Lesson 14. 스위치의 구조

스위치와 허브의 차이점 : 

스위치 내부에는 MAC 주소 테이블 이라는 것이 있음. 이는 스위치의 포트 번호와 해당 포트에 연결되어 있는 컴퓨터의 MAC주소가 등록되는 데이터베이스

컴퓨터에서 목적지 MAC주소가 추가된 프레임이라는 데이터가 전송되면, MAC주소 테이블을 확인하고, 

1. 출발지 MAC주소가 등록되어 있지 않으면 MAC주소를 포트와 함께 등록(MAC 주소 학습 기능)
2. 목적지 MAC주소가 등록되어 있지 않으면 허브처럼 모든 포트에 프레임을 전송(플러딩)
3. 만약 목적지 MAC주소가 등록되어 있다면, 해당 목적지에만 프레임이 전송됨(MAC 주소 필터링)



## Lesson 15. 데이터가 케이블에서 충돌하지 않는 구조

1. 전이중 통신 방식 : 데이터의 송수신을 동시에 통신, 데이터를 동시에 전송해도 충돌 x
2. 반이중 통신 방식 : 회선 하나로 송수신을 번갈아가면서 통신, 데이터를 동시에 전송하면 충돌 o



컴퓨터와 컴퓨터를 연결하면 전이중 통신 방식이 된다. (Lesson 10의 크로스 케이블 참고)

허브 내부에는 송신과 수신이 나누어져 있지 않기 때문에 반이중 통신 방식 사용

반면 스위치는 내부에 송신과 수신이 나누어져 있으므로 전이중 통신 방식으로 데이터를 주고받을 수 있음



충돌 도메인 :

충돌이 발생할 때 그 영향이 미치는 범위

허브를 사용할 경우, 연결되어 있는 컴퓨터 전체가 하나의 충돌 도메인이 됨

스위치를 사용할 경우, 전이중 통신 방식이기 때문에 충돌이 일어나지 않고, 충돌 도메인의 범위도 각 포트로 좁다



+ ARP(Address Resolution Protocol)

  목적지 컴퓨터의 IP주소를 이용하여 MAC 주소를 찾기 위한 프로토콜

  출발지 컴퓨터가 목적지 주소를 모르면 MAC 주소를 알아내기 위해 네트워크에 브로드캐스트를 하는데, 이를 ARP request라고 함

  이 요청에 대해 해당 IP주소를 가진 컴퓨터만 MAC 주소를 응답으로 보냄, 이를 ARP reply라고 함

  이것으로 출발지 컴퓨터는 목적지의 MAC 주소를 알아내서 이더넷 프레임을 만들 수 있음

  출발지 컴퓨터는 MAC주소를 얻은 후에 MAC주소와 IP주소의 매핑 정보를 메모리에 보관하는데 이 정보를 ARP table이라고 함. 이후 데이터 통신은 자신 컴퓨터에 보관된 ARP table을 참고하여 전송됨

  목적지의 IP주소가 변경된다면 제대로 통신할 수 없게 되므로, 보존 기간을 ARP 캐시로 지정하고 일정 시간이 지나면 삭제하고 다시 ARP 요청을 함



## Lesson 16. 이더넷의 종류와 특징

이더넷은 케이블의 종류나 통신 속도에 따라 다양한 규격으로 분리됨

e.g. ) 10BASE-T

10 : 통신 속도 10Mbps

BASE : BASEBAND 라는 전송 방식을 의미

T : 케이블 종류(UTP Cable)
